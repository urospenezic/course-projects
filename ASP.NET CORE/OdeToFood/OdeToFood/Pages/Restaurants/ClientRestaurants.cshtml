@page
@model MyApp.Namespace.ClientRestaurantsModel
@{
    ViewData["Title"] = "Restaurants";
}

<div class="container">
    <div class="row">
        <div class="col-12">
            <h2>All Restaurants</h2>
            <p>Browse our collection of restaurants</p>
            <table id="restaurantsTable" class="table table-striped table-hover" style="width:100%">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Cuisine</th>
                        <th>Location</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Data will be loaded via AJAX -->
                </tbody>
            </table>
        </div>
    </div>
</div>

@section Scripts {
    <environment exclude="Development">
        <!-- DataTables CSS -->
        <link rel="stylesheet" href="https://cdn.datatables.net/1.13.7/css/dataTables.bootstrap5.min.css" />
        <link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.4.2/css/buttons.bootstrap5.min.css" />

        <!-- DataTables JS -->
        <script src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.min.js"></script>
        <script src="https://cdn.datatables.net/1.13.7/js/dataTables.bootstrap5.min.js"></script>
        <script src="https://cdn.datatables.net/buttons/2.4.2/js/dataTables.buttons.min.js"></script>
        <script src="https://cdn.datatables.net/buttons/2.4.2/js/buttons.bootstrap5.min.js"></script>
    </environment>

    <environment include="Development">
        <!-- DataTables CSS - Local -->
        <link rel="stylesheet" href="~/node_modules/datatables.net-dt/css/dataTables.dataTables.min.css" />
        <link rel="stylesheet" href="~/node_modules/datatables.net-bs5/css/dataTables.bootstrap5.min.css" />
        <link rel="stylesheet" href="~/node_modules/datatables.net-buttons-bs5/css/buttons.bootstrap5.min.css" />

        <!-- DataTables JS - Local -->
        <script src="~/node_modules/datatables.net/js/dataTables.min.js"></script>
        <script src="~/node_modules/datatables.net-bs5/js/dataTables.bootstrap5.min.js"></script>
        <script src="~/node_modules/datatables.net-buttons/js/dataTables.buttons.min.js"></script>
        <script src="~/node_modules/datatables.net-buttons-bs5/js/buttons.bootstrap5.min.js"></script>
    </environment>

    <script>
        $(document).ready(function () {
            let cuisine = ["Unknown", "Mexican", "Italian", "Indian"];
            $('#restaurantsTable').DataTable({
                "ajax": {
                    "url": "/api/Restaurants",
                    "type": "GET",
                    "dataSrc": ""
                },
                "columns": [
                    { "data": "name" },
                    {
                        "data": "cuisine", render: function (data) { return cuisine[data] || data; }
                    },
                    { "data": "location" },
                    {
                        "data": "id",
                        "orderable": false,
                        "render": function (data, type, row) {
                            return `
                                    <div class="btn-group" role="group" aria-label="Restaurant actions">
                                        <a href="/Restaurants/Details?restaurantId=${data}" class="btn btn-outline-primary btn-sm">
                                            <i class="bi bi-eye"></i> Details
                                        </a>
                                        <a href="/Restaurants/Edit?restaurantId=${data}" class="btn btn-outline-secondary btn-sm">
                                            <i class="bi bi-pencil"></i> Edit
                                        </a>
                                        <a href="/Restaurants/Delete?restaurantId=${data}" class="btn btn-outline-danger btn-sm">
                                            <i class="bi bi-trash"></i> Delete
                                        </a>
                                    </div>
                                `;
                        }
                    }
                ],
                "responsive": true,
                "pageLength": 10,
                "lengthMenu": [5, 10, 25, 50],
                "language": {
                    "search": "Search restaurants:",
                    "lengthMenu": "Show _MENU_ restaurants per page",
                    "info": "Showing _START_ to _END_ of _TOTAL_ restaurants",
                    "infoEmpty": "No restaurants found",
                    "infoFiltered": "(filtered from _MAX_ total restaurants)"
                }
            });
        });
    </script>
}